/* polygonchart.js@v0.0.2 (es) */(function(a,b){"object"==typeof exports&&"undefined"!=typeof module?module.exports=b():"function"==typeof define&&define.amd?define(b):(a=a||self,a.PolygonChart=b())})(this,function(){'use strict';var a=Math.PI;return function(b){var c=Math.sin,d=Math.cos;const e=this,f=b=>parseFloat(b)*a/180,g={makeCircle:(a={})=>{const b=Object.assign({fill:"transparent",stroke:"none",radius:0,strokeWidth:"0"},a),c=g.createSVGElement("circle");return c.setAttribute("fill",b.fill),c.setAttribute("stroke",b.stroke),c.setAttribute("r",b.radius),c.setAttribute("stroke-width",b.strokeWidth),c.setAttribute("stroke-linecap","round"),c},makeLabel:a=>{const b=Object.assign({text:"",x:0,y:0,color:"",fontFamily:"sans-serif",fontSize:"7px"},a),c=g.createSVGElement("text");return c.setAttribute("text-anchor","middle"),c.setAttribute("font-family",b.fontFamily),c.setAttribute("font-size",b.fontSize),c.setAttribute("fill",b.color),c.setAttribute("x",b.x),c.setAttribute("y",b.y),c.textContent=b.text,c},makePolygon:(a=[],b)=>{const c=Object.assign({fill:"#000",stroke:"#000",strokeWidth:"1px"},b),d=g.createSVGElement("polygon");return d.setAttribute("stroke-linecap","round"),d.setAttribute("points",a),d.setAttribute("fill",c.fill),d.setAttribute("stroke",c.stroke),d.setAttribute("stroke-width",c.strokeWidth),d},getSVG:(a=0)=>{const b=2*parseFloat(a),c=g.createSVGElement("svg","polygonchart");return c.setAttribute("xmlns","http://www.w3.org/2000/svg"),c.setAttribute("polygonchart",""),c.setAttribute("height",`${b}px`),c.setAttribute("width",`${b}px`),c.setAttribute("viewBox",`0 0 ${b} ${b}`),c},createSVGElement:(a,b)=>{const c=document.createElementNS("http://www.w3.org/2000/svg",a);return b&&c.setAttribute("data-name",b),c}};//
e.options=Object.assign({target:null,radius:0,data:{data:[],sides:0,tooltips:{roundTo:0,percentage:!1},colors:{normal:{polygonStroke:"#1e3d96",polygonFill:"rgba(39, 78, 192,.5)",pointStroke:"transparent",pointFill:"#1e3d96"},onHover:{polygonStroke:"#1a3480",polygonFill:"rgba(39, 78, 192,.85)",pointStroke:"transparent",pointFill:"#1a3480"}}},polygon:{colors:{normal:{fill:"#fff",stroke:"#8c8c8c"},onHover:{splineFill:"#fff",splineStroke:"#000"}}},levels:{count:5,labels:{enabled:!0,position:{spline:1,quadrant:0},colors:{normal:"#8c8c8c",onHover:"#000"}}},tippy:{},anime:{duration:1e3,easing:"linear"},animation:{autoplay:!1}},b),e.svg=null,e.animations=[];let h,j,k,l=[],n=[],o=[],p=-1,q=-1,r=-1,s=-1,t=-1,u=-1;//
const v={onEnterDataPoint:a=>{a.setAttribute("fill",e.options.data.colors.onHover.pointFill),a.setAttribute("stroke",e.options.data.colors.onHover.pointStroke)},onLeaveDataPoint:a=>{a.setAttribute("fill",e.options.data.colors.normal.pointFill),a.setAttribute("stroke",e.options.data.colors.normal.pointStroke)},onEnterSpline:a=>{a.setAttribute("fill",e.options.polygon.colors.onHover.fill),a.setAttribute("stroke",e.options.polygon.colors.onHover.stroke);const b=a.getAttribute("index"),c=j.querySelector(`text[index='${b}']`);c&&c.setAttribute("fill",e.options.levels.labels.colors.onHover)},onLeaveSpline:a=>{a.setAttribute("fill",e.options.polygon.colors.normal.fill),a.setAttribute("stroke",e.options.polygon.colors.normal.stroke);const b=a.getAttribute("index"),c=j.querySelector(`text[index='${b}']`);c&&c.setAttribute("fill",e.options.levels.labels.colors.normal)},onEnterDataPoly:a=>{a.setAttribute("fill",e.options.data.colors.onHover.polygonFill),a.setAttribute("stroke",e.options.data.colors.onHover.polygonStroke)},onLeaveDataPoly:a=>{a.setAttribute("fill",e.options.data.colors.normal.polygonFill),a.setAttribute("stroke",e.options.data.colors.normal.polygonStroke)}},w=()=>{const a=g.createSVGElement("g","data"),b=g.createSVGElement("g","data-points");for(let a=1;a<=e.options.data.sides;a++){const c=g.createSVGElement("g",`point-${a}`),d=g.makeCircle({radius:10}),f=g.makeCircle({fill:e.options.data.colors.normal.pointFill,stroke:e.options.data.colors.normal.pointStroke,radius:4,strokeWidth:"2px"});c.appendChild(d),c.appendChild(f),b.appendChild(c),c.addEventListener("mouseenter",v.onEnterDataPoint.bind(this,f)),c.addEventListener("touchstart",v.onEnterDataPoint.bind(this,f)),c.addEventListener("mouseleave",v.onLeaveDataPoint.bind(this,f)),c.addEventListener("touchend",v.onLeaveDataPoint.bind(this,f)),c.style.setProperty("cursor","pointer"),l.push(c)}a.appendChild(k),e.svg.appendChild(a),e.svg.appendChild(b)},x=()=>{const{radius:a}=e.options;for(let b,g=0;g<e.options.data.data.length;g++){b="";for(let h=1,i=0;h<=e.options.data.sides;h++,i++){const j=f(t*h-q),k=a*e.options.data.data[g][i]*d(j)+a,l=a*e.options.data.data[g][i]*c(j)+a;b+=`${k},${l} `,Array.isArray(n[i])||(n[i]=[]),n[i].push({x:k,y:l})}o.push(b)}},y=(a=-1)=>{const{radius:b}=e.options;let g="";for(let h=1,i=0;h<=e.options.data.sides;h++,i++){const j=f(t*h-q),k=b*e.options.data.data[a][i]*d(j)+b,m=b*e.options.data.data[a][i]*c(j)+b;g+=`${k},${m} `;let n=e.options.data.data[a][i];e.options.data.tooltips.percentage&&(n*=100),e.options.data.tooltips.roundTo&&(n=n.toFixed(e.options.data.tooltips.roundTo));const o=`${n}${e.options.data.tooltips.percentage?"%":""}`;l[i].style.setProperty("transform",`translateX(${k}px) translateY(${m}px)`),l[i].setAttribute("data-value",n),l[i].setAttribute("data-tippy-content",o)}k.setAttribute("points",g)},z=(a={})=>{var b=Math.floor;const{radius:i,levels:k}=a;let l;k===e.options.levels.count&&(l=g.createSVGElement("g","crosshairs"));let m="",n=-1;for(let b=1;b<=e.options.data.sides;b++){const a=f(t*b-q),g=i*d(a)+e.options.radius,h=i*c(a)+e.options.radius;/* + appended space */if(n=p?g:h,u&&(n-=(h-g)/e.options.data.sides),m+=`${g},${h} `,k===e.options.levels.count){const b=s*d(a)+e.options.radius,f=s*c(a)+e.options.radius,g=r*d(a)+e.options.radius,h=r*c(a)+e.options.radius,i=document.createElementNS("http://www.w3.org/2000/svg","line");i.setAttribute("stroke",e.options.polygon.colors.normal.stroke),i.setAttribute("x1",b),i.setAttribute("y1",f),i.setAttribute("x2",g),i.setAttribute("y2",h),l&&l.appendChild(i)}}const o=100/e.options.levels.count*k,w=`${o}%`;let x=`${e.options.radius}px`;const y=u?2:0,A=`${n+y}px`,B=6*(w.length-1),C=g.makeLabel({text:w,x:x,y:A,color:e.options.levels.labels.colors.normal});if(C.setAttribute("index",k),u){const a=e.options.levels.labels.position.quadrant%e.options.data.sides>=b(e.options.data.sides/2);if(p);else{let b=`${n+B}px`,c=0;a&&(c=180,b=A),C.style.setProperty("transform-origin",`${x} ${b}`),C.style.setProperty("transform",`rotateZ(${c}deg)`)}}else{let a=e.options.data.sides/2;p&&(a=b(a));const c=e.options.levels.labels.position.spline%e.options.data.sides>=a;if(p);else{let a=`${n-2+B}px`,b=180/e.options.data.sides;c&&(b+=180,x=`${e.options.radius-7}px`,a=A),C.style.setProperty("transform-origin",`${x} ${a}`),C.style.setProperty("transform",`rotateZ(${-b}deg)`)}}0!==k&&j.appendChild(C);const D=g.makePolygon(m,{stroke:e.options.polygon.colors.normal.stroke,fill:e.options.polygon.colors.normal.fill});// additional inner polygon ...
if(D.setAttribute("index",k),D.addEventListener("mouseenter",v.onEnterSpline.bind(this,D)),D.addEventListener("touchstart",v.onEnterSpline.bind(this,D)),D.addEventListener("mouseleave",v.onLeaveSpline.bind(this,D)),D.addEventListener("touchend",v.onLeaveSpline.bind(this,D)),h.appendChild(D),0<k){const a=i-e.options.radius/e.options.levels.count,b=0<=k-1?k-1:0;z({radius:a,levels:b})}e.svg.appendChild(h),k===e.options.levels.count&&e.svg.appendChild(l),e.svg.appendChild(j)},A=()=>{const a=180/e.options.data.sides;let b=0;b=u?a+2*a*(e.options.levels.labels.position.quadrant-1):2*a*e.options.levels.labels.position.spline,j.style.setProperty("transform-origin",`${e.options.radius}px ${e.options.radius}px`),j.style.setProperty("transform",`rotateZ(${b}deg)`)},B=()=>{const a=e.options.target.querySelector("[polygonchart]");a&&a.remove(),l=[],n=[],o=[],h=g.createSVGElement("g","splines"),j=g.createSVGElement("g","labels"),e.svg=g.getSVG(e.options.radius),k=g.makePolygon("",{fill:e.options.data.colors.normal.polygonFill,stroke:e.options.data.colors.normal.polygonStroke}),k.addEventListener("mouseenter",v.onEnterDataPoly.bind(this,k)),k.addEventListener("touchstart",v.onEnterDataPoly.bind(this,k)),k.addEventListener("mouseleave",v.onLeaveDataPoly.bind(this,k)),k.addEventListener("touchend",v.onLeaveDataPoly.bind(this,k)),p=0==e.options.data.sides%2,q=p?360/(2*e.options.data.sides):90,u=0!==e.options.levels.labels.position.quadrant,r=e.options.radius,s=e.options.radius/e.options.levels.count,t=360/e.options.data.sides,e.options.target.appendChild(e.svg)},C=()=>{const a=window.anime||null;if("undefined"!=typeof a&&null!==a){// : todo :
const b=a({...e.options.anime,targets:k,autoplay:!1,points:o.map(a=>({value:a}))});e.animations.push(b);for(let b=0;b<l.length;b++){const c=l[b],d=n[b];if(d){// : todo :
const b=a({...e.options.anime,targets:c,autoplay:!1,translateX:d.map(({x:a})=>({value:a})),translateY:d.map(({y:a})=>({value:a}))});e.animations.push(b)}}e.options.animation.autoplay&&e.start()}};//
return e.init=()=>{B(),z({levels:e.options.levels.count,radius:e.options.radius}),w(),y(0),x(),A(),C();const a=window.tippy||null;return"undefined"==typeof a||null===a?e:(a("[data-tippy-content]",e.options.tippy),e)},e.startAnimation=()=>{const{animations:a}=e;for(let b=0;b<a.length;b++)a[b].play();return e},e.resetAnimation=()=>{const{animations:b}=e;for(let c=0;c<b.length;c++){const d=b[c];d.restart(),d.pause()}return e},e.stopAnimation=()=>{const{animations:a}=e;for(let b=0;b<a.length;b++)a[b].pause();return e},e.seekAnimation=(a=0)=>{const{animations:b}=e;for(let c=0;c<b.length;c++)b[c].seek(a);return e},e.reload=()=>(e.init(),e),e}});
